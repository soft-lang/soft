CREATE OR REPLACE FUNCTION "EVAL"."LEAVE_BLOCK_EXPRESSION"(_NodeID integer) RETURNS void
LANGUAGE plpgsql
AS $$
DECLARE
_LastNodeID integer;
_OK         boolean;
BEGIN

SELECT     ParentNodeID
INTO STRICT _LastNodeID
FROM Edges
WHERE ChildNodeID = _NodeID
AND DeathPhaseID IS NULL
ORDER BY EdgeID DESC
LIMIT 1;

UPDATE Nodes SET ReferenceNodeID = _LastNodeID WHERE NodeID = _NodeID RETURNING TRUE INTO STRICT _OK;

RETURN;
END;
$$;
